
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Meet PyMKS &mdash; PyMKS</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.2.0/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pymks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/pymks_logo.ico"/>
    <link rel="top" title="PyMKS" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><img src="_static/pymks_logo.png">
          PyMKS</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="rst/INSTALLATION.html">Installation</a></li>
                <li><a href="EXAMPLES.html">Examples</a></li>
                <li><a href="API.html">API</a></li>
                <li><a href="https://github.com/materialsinnovation/pymks/">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">More <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="THEORY.html">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rst/derivation.html">Derivation of MKS Localization Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rst/tech_overview.html">Technical Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rst/CREDITS.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst/LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst/CITATION.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst/REQUIREMENTS.html">Requirements</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="meet-pymks">
<h1>Meet PyMKS<a class="headerlink" href="#meet-pymks" title="Permalink to this headline">¶</a></h1>
<p>In this short introduction, we will demonstrate the functionality of
PyMKS to compute 2-point statistics in order to objectively quantify
microstructures, predict effective properties using homogenization and
predict local properties using localization. If you would like more
technical details amount any of these methods please see the <a class="reference external" href="THEORY.html">theory
section</a>.</p>
<div class="code python highlight-python"><div class="highlight"><pre>%matplotlib inline
%load_ext autoreload
%autoreload 2

import numpy as np
import matplotlib.pyplot as plt
</pre></div>
</div>
<div class="section" id="quantify-microstructures-using-2-point-statistics">
<h2>Quantify Microstructures using 2-Point Statistics<a class="headerlink" href="#quantify-microstructures-using-2-point-statistics" title="Permalink to this headline">¶</a></h2>
<p>Lets make two dual phase microstructures with different morphologies.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_microstructure</span>

<span class="n">X_1</span> <span class="o">=</span> <span class="n">make_microstructure</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">grain_size</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
<span class="n">X_2</span> <span class="o">=</span> <span class="n">make_microstructure</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">grain_size</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">95</span><span class="p">))</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_1</span><span class="p">,</span> <span class="n">X_2</span><span class="p">))</span>
</pre></div>
</div>
<p>Throughout PyMKS <tt class="docutils literal"><span class="pre">X</span></tt> is used to represent microstructures. Now that we
have made the two microstructures, lets take a look at them.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_microstructures</span>

<span class="n">draw_microstructures</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/intro_5_0.png" src="_images/intro_5_0.png" />
<p>We can compute the 2-point statistics for these two periodic
microstructures using the <tt class="docutils literal"><span class="pre">correlate</span></tt> function from <tt class="docutils literal"><span class="pre">pymks.stats</span></tt>.
This function computes all of the autocorrelations and
cross-correlation(s) for a microstructure. Before we compute the 2-point
statistics, we will discretize them using the <tt class="docutils literal"><span class="pre">PrimitiveBasis</span></tt>
function.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="kn">from</span> <span class="nn">pymks.stats</span> <span class="kn">import</span> <span class="n">correlate</span>

<span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">X_</span> <span class="o">=</span> <span class="n">prim_basis</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_corr</span> <span class="o">=</span> <span class="n">correlate</span><span class="p">(</span><span class="n">X_</span><span class="p">,</span> <span class="n">periodic_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>Let&#8217;s take a look at the two autocorrelations and the cross-correlation
for these two microstructures.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_correlations</span>

<span class="k">print</span> <span class="n">X_corr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

<span class="n">draw_correlations</span><span class="p">(</span><span class="n">X_corr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/intro_9_1.png" src="_images/intro_9_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">draw_correlations</span><span class="p">(</span><span class="n">X_corr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/intro_10_0.png" src="_images/intro_10_0.png" />
<p>2-Point statistics provide an object way to compare microstructures, and
have been shown as an effective input to machine learning methods.</p>
</div>
<div class="section" id="predict-homogenized-properties">
<h2>Predict Homogenized Properties<a class="headerlink" href="#predict-homogenized-properties" title="Permalink to this headline">¶</a></h2>
<p>In this section of the intro, we are going to predict the effective
stiffness for two phase microstructures using the
<tt class="docutils literal"><span class="pre">MKSHomogenizationModel</span></tt>, but we could have chosen any other effective
material property.</p>
<p>First we need to make some microstructures and their effective stress
values to fit our model. Let&#8217;s create 200 random instances 3 different
types of microstructures, totaling to 600 microstructures.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_elastic_stress_random</span>

<span class="n">grain_size</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">47</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">)]</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">make_elastic_stress_random</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
                                              <span class="n">grain_size</span><span class="o">=</span><span class="n">grain_size</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Once again, <tt class="docutils literal"><span class="pre">X_train</span></tt> is our microstructures. Throughout PyMKS <tt class="docutils literal"><span class="pre">y</span></tt>
is used as either the prpoerty or the field we would like to predict. In
this case <tt class="docutils literal"><span class="pre">y_train</span></tt> is the effective stress values for <tt class="docutils literal"><span class="pre">X_train</span></tt>.
Let&#8217;s look at one of each of the three different types of
microstructures.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">draw_microstructures</span><span class="p">(</span><span class="n">X_train</span><span class="p">[::</span><span class="mi">200</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/intro_16_0.png" src="_images/intro_16_0.png" />
<p>The <tt class="docutils literal"><span class="pre">MKSHomogenizationModel</span></tt> uses 2-point statistics, so we need
provide a discretization method for the microstructures by providing a
basis function. We will also specify which correlations we want.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">MKSHomogenizationModel</span>

<span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">homogenize_model</span> <span class="o">=</span> <span class="n">MKSHomogenizationModel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">prim_basis</span><span class="p">,</span>
                                          <span class="n">correlations</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
<p>Let&#8217;s fit our model with the data we created.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">homogenize_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">periodic_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>Now let&#8217;s make some new data to see how good our model is.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n_samples</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">make_elastic_stress_random</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
                                            <span class="n">grain_size</span><span class="o">=</span><span class="n">grain_size</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>We will try and predict the effective stress of our <tt class="docutils literal"><span class="pre">X_test</span></tt>
microstructures.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">y_pred</span> <span class="o">=</span> <span class="n">homogenize_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">periodic_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">MKSHomogenizationModel</span></tt> generates low dimensional representations
of microstructures and regression methods to predict effective
properties. Take a look at the low dimensional representations.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_components</span>

<span class="n">draw_components</span><span class="p">(</span><span class="n">homogenize_model</span><span class="o">.</span><span class="n">fit_data</span><span class="p">,</span> <span class="n">homogenize_model</span><span class="o">.</span><span class="n">predict_data</span><span class="p">,</span>
                <span class="n">label_1</span><span class="o">=</span><span class="s">&#39;Training Data&#39;</span><span class="p">,</span> <span class="n">label_2</span><span class="o">=</span><span class="s">&#39;Testing Data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/intro_26_0.png" src="_images/intro_26_0.png" />
<p>Now let&#8217;s look at a goodness of fit plot for our
<tt class="docutils literal"><span class="pre">MKSHomogenizationModel</span></tt>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_goodness_of_fit</span>

<span class="n">fit_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y_train</span><span class="p">,</span>
                     <span class="n">homogenize_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">periodic_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])])</span>
<span class="n">pred_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">])</span>

<span class="n">draw_goodness_of_fit</span><span class="p">(</span><span class="n">fit_data</span><span class="p">,</span> <span class="n">pred_data</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;Training Data&#39;</span><span class="p">,</span> <span class="s">&#39;Testing Data&#39;</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/intro_28_0.png" src="_images/intro_28_0.png" />
<p>Looks good.</p>
<p>The <tt class="docutils literal"><span class="pre">MKSHomogenizationModel</span></tt> can be used to predict effective
properties and processing-structure evolutions.</p>
</div>
<div class="section" id="predict-local-properties">
<h2>Predict Local Properties<a class="headerlink" href="#predict-local-properties" title="Permalink to this headline">¶</a></h2>
<p>In this section of the intro, we are going to predict the local strain
field in a microstructure using <tt class="docutils literal"><span class="pre">MKSLocalizationModel</span></tt>, but we could
have predicted another local property.</p>
<p>First we need some data, so let&#8217;s make some.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_elastic_FE_strain_delta</span>

<span class="n">X_delta</span><span class="p">,</span> <span class="n">y_delta</span> <span class="o">=</span> <span class="n">make_elastic_FE_strain_delta</span><span class="p">()</span>
</pre></div>
</div>
<p>Once again, <tt class="docutils literal"><span class="pre">X_delta</span></tt> is our microstructures and <tt class="docutils literal"><span class="pre">y_delta</span></tt> is our
local strain fields. We need to discretize the microstructure again so
we will also use the same basis function.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">MKSLocalizationModel</span>

<span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">localize_model</span> <span class="o">=</span> <span class="n">MKSLocalizationModel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">prim_basis</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s use the data to fit our <tt class="docutils literal"><span class="pre">MKSLocalizationModel</span></tt>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">localize_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_delta</span><span class="p">,</span> <span class="n">y_delta</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have fit our model, we will create a random microstructure
and compute its local strain field using finite element analysis. We
will then try and reproduce the same strain field with our model.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_elastic_FE_strain_random</span>

<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">make_elastic_FE_strain_random</span><span class="p">()</span>
</pre></div>
</div>
<p>Let&#8217;s look at the microstructure and its local strain field.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_microstructure_strain</span>

<span class="n">draw_microstructure_strain</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_test</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/intro_40_0.png" src="_images/intro_40_0.png" />
<p>Now let&#8217;s pass that same microstructure to our <tt class="docutils literal"><span class="pre">MKSLocalizationModel</span></tt>
and compare the predicted and computed local strain field.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_strains_compare</span>


<span class="n">y_pred</span> <span class="o">=</span> <span class="n">localize_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">draw_strains_compare</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/intro_42_0.png" src="_images/intro_42_0.png" />
<p>Not bad.</p>
<p>The <tt class="docutils literal"><span class="pre">MKSLocalizationModel</span></tt> can be used to predict local properties and
local processing-structure evolutions.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>